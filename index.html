<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Dog Money üê∂</title>
<style>
:root { --gold: linear-gradient(135deg,#ffcc00,#ff9f00);}
*{
    box-sizing:border-box;
    font-family:'Segoe UI',sans-serif;
    /* –£–±–∏—Ä–∞–µ–º —Å–∏–Ω–∏–π —Ñ–æ–Ω –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –º–æ–±–∏–ª–∫–∞—Ö */
    -webkit-tap-highlight-color: transparent;
    user-select: none;
}
html,body{margin:0;padding:0;height:100%;background:radial-gradient(circle at top,#fff2d6,#ffd28a);overflow:hidden;}
header{text-align:center;padding:20px 15px; animation: fadeIn 1s ease;}

@keyframes fadeIn { from {opacity: 0;} to {opacity: 1;} }

.header-img{width:100%;max-width:340px;border-radius:22px;box-shadow:0 14px 35px rgba(0,0,0,0.3);}
.small{font-size:14px;opacity:0.7;margin-top:8px;}

.container{padding:15px;padding-bottom:120px; height: 100vh; overflow-y: auto;}

.card{
    background:#fff;
    border-radius:22px;
    padding:18px;
    margin-bottom:16px;
    box-shadow:0 15px 35px rgba(0,0,0,0.12);
    animation: slideUp 0.6s ease-out backwards;
}

@keyframes slideUp { 
    from { opacity: 0; transform: translateY(30px); } 
    to { opacity: 1; transform: translateY(0); } 
}

.btn{
    width:100%;
    padding:14px;
    border:none;
    border-radius:18px;
    font-size:16px;
    font-weight:600;
    cursor:pointer;
    background:var(--gold);
    box-shadow:0 8px 20px rgba(255,170,0,0.4);
    transition: transform 0.1s, box-shadow 0.2s;
    color: #000;
}
.btn:active{transform:scale(0.96); box-shadow: 0 4px 10px rgba(255,170,0,0.2);}

.section{display:none;}
.section.active{display:block;}

nav{position:fixed;bottom:12px;left:12px;right:12px;height:64px;background:rgba(255,255,255,0.9);backdrop-filter:blur(15px);border-radius:22px;display:flex;padding:6px;z-index:999;box-shadow:0 10px 30px rgba(0,0,0,0.2);}
nav button{flex:1;border:none;background:none;border-radius:16px;font-size:13px;font-weight:600;cursor:pointer; transition: all 0.3s;}
nav button.active{background:var(--gold); box-shadow: 0 6px 15px rgba(255,170,0,0.4);}

/* –ê–Ω–∏–º–∞—Ü–∏—è —Ä–∞–∑–ª–µ—Ç–∞—é—â–∏—Ö—Å—è –∫–æ—Å—Ç–æ—á–µ–∫ */
.bone{
    position:fixed;
    font-size:26px;
    pointer-events:none;
    z-index:1000;
    animation: boneExplode 0.9s cubic-bezier(0.1, 0.8, 0.3, 1) forwards;
}

@keyframes boneExplode {
    0% { opacity: 1; transform: translate(0,0) scale(1) rotate(0deg); }
    100% { opacity: 0; transform: translate(var(--ex), var(--ey)) scale(1.4) rotate(var(--er)); }
}

.profile-photo{width:64px;height:64px;border-radius:50%;object-fit:cover;margin-bottom:8px; border: 3px solid #fff; box-shadow: 0 4px 10px rgba(0,0,0,0.1);}
#overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.96);display:none;z-index:10000;color:#fff;overflow:auto;padding:25px; animation: fadeIn 0.3s;}
#overlay .closeBtn{position:absolute;top:15px;right:15px;background:var(--gold);color:#000;border:none;padding:12px 20px;border-radius:15px;font-weight:bold;cursor:pointer;}

#adminTable { width: 100%; border-collapse: collapse; margin-top: 20px; }
#adminTable td, #adminTable th { padding: 10px; border-bottom: 1px solid #333; font-size: 13px; text-align: left;}
#adminTable input { width: 55px; background: #222; color: #fff; border: 1px solid #444; border-radius: 5px; padding: 5px; }
.save-btn-min { background: var(--gold); border:none; padding: 5px 10px; border-radius: 8px; font-weight: bold; cursor:pointer;}
</style>
<script src="https://www.gstatic.com/firebasejs/10.2.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.2.0/firebase-firestore.js"></script>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>

<header>
  <img class="header-img" src="https://i.postimg.cc/nrrTt15j/Giga-Chat-36.jpg" alt="Dog Money">
  <div class="small">–¢–≤–æ–π –≤–µ—Ä–Ω—ã–π –ø—É—Ç—å –∫ —É—Å–ø–µ—Ö—É üê∂</div>
</header>

<div class="container">
  <div id="earn" class="section active">
    <div class="card" style="animation-delay: 0.1s;">
      <h2>üêæ –ö–ª–∏–∫–∏</h2>
      <p>–¢–∞–ø–∞–π –ø–æ —ç–∫—Ä–∞–Ω—É –∏ —Å–æ–±–∏—Ä–∞–π –Ω–∞–≥—Ä–∞–¥—ã!</p>
      <button class="btn actionBtn" data-type="click">–ù–∞—á–∞—Ç—å —Ç–∞–ø–∞—Ç—å üêï</button>
      <p id="clicks">–ö–ª–∏–∫–æ–≤: 0</p>
    </div>
    <div class="card" style="animation-delay: 0.2s;">
      <h2>üìã –ó–∞–¥–∞–Ω–∏—è</h2>
      <p>–í—ã–ø–æ–ª–Ω—è–π –∫–≤–µ—Å—Ç—ã –∏ –±–æ–≥–∞—Ç–µ–π.</p>
      <button class="btn actionBtn" data-type="tasks">–°–º–æ—Ç—Ä–µ—Ç—å –∑–∞–¥–∞–Ω–∏—è</button>
    </div>
    <div class="card" style="animation-delay: 0.3s;">
      <h2>ü§ù –†–µ—Ñ–µ—Ä–∞–ª—ã</h2>
      <p>–ë–æ–ª—å—à–µ –¥—Ä—É–∑–µ–π ‚Äî –±–æ–ª—å—à–µ –∫–æ—Å—Ç–æ—á–µ–∫!</p>
      <button class="btn actionBtn" data-type="referrals">–ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å</button>
    </div>
  </div>

  <div id="profile" class="section">
    <div class="card">
      <img src="" alt="–§–æ—Ç–æ" class="profile-photo" id="profilePhoto">
      <h2 id="profileUsername">–ó–∞–≥—Ä—É–∑–∫–∞...</h2>
      <p>–¢–≤–æ–π ID: <span id="profileId">‚Äî</span></p>
      <p>–ë–∞–ª–∞–Ω—Å: <b id="profileBalance">0 ü™ô</b></p>
      <p>–í—Å–µ–≥–æ –∫–ª–∏–∫–æ–≤: <span id="profileClicks">0</span></p>
    </div>
  </div>

  <div id="info" class="section">
    <div class="card">
      <h2>üõ° –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</h2>
      <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Å–µ–º–∏ –∏–≥—Ä–æ–∫–∞–º–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.</p>
      <button class="btn" id="openAdmin">–û—Ç–∫—Ä—ã—Ç—å –±–∞–∑—É</button>
    </div>
    <div class="card">
      <h2>üì∞ –ö–∞–Ω–∞–ª –ø—Ä–æ–µ–∫—Ç–∞</h2>
      <button class="btn">–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è</button>
    </div>
    <div class="card">
      <h2>üõ† –ü–æ–¥–¥–µ—Ä–∂–∫–∞</h2>
      <p>–ï—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã? –ü–∏—à–∏ <b>@support_dogmoney</b></p>
    </div>
  </div>
</div>

<nav>
  <button id="btn-earn" class="active" onclick="openSection('earn')">üí∞ –ò–≥—Ä–∞—Ç—å</button>
  <button id="btn-profile" onclick="openSection('profile')">üë§ –ü—Ä–æ—Ñ–∏–ª—å</button>
  <button id="btn-info" onclick="openSection('info')">‚ÑπÔ∏è –ò–Ω—Ñ–æ</button>
</nav>

<div id="overlay">
  <button class="closeBtn" onclick="document.getElementById('overlay').style.display='none'">‚úñ</button>
  <div id="overlayContent"></div>
</div>

<script>
const tg = window.Telegram.WebApp;
tg.ready();
tg.expand();

// Firebase
const firebaseConfig = {
    apiKey: "AIzaSyDeY43dAjpJ2NxHneG4W66veHNBiQ5jhfA",
    authDomain: "dogsmoney.firebaseapp.com",
    projectId: "dogsmoney",
    storageBucket: "dogsmoney.firebasestorage.app",
    messagingSenderId: "339745413806",
    appId: "1:339745413806:web:08f8fdd856ee92a3002b3f"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

let clicks = 0, balance = 0, userRef, userId = 0;

function initUser(user) {
    userId = user.id;
    document.getElementById("profileUsername").innerText = "@" + (user.username || "–ò–≥—Ä–æ–∫");
    document.getElementById("profileId").innerText = userId;
    if(user.photo_url) document.getElementById("profilePhoto").src = user.photo_url;

    userRef = db.collection("users").doc(String(userId));
    userRef.get().then(docSnap => {
        if(!docSnap.exists) {
            userRef.set({username: user.username || "User", balance: 0, clicks: 0});
        } else {
            const data = docSnap.data();
            clicks = data.clicks || 0; balance = data.balance || 0;
            updateUI();
        }
    });
}

function updateUI() {
    document.getElementById("profileBalance").innerText = balance + " ü™ô";
    document.getElementById("profileClicks").innerText = clicks;
    document.getElementById("clicks").innerText = "–ö–ª–∏–∫–æ–≤: " + clicks;
}

// "–í–∑—Ä—ã–≤–Ω–æ–π" —ç—Ñ—Ñ–µ–∫—Ç –∫–æ—Å—Ç–æ—á–µ–∫
function createBones(x, y) {
    for(let i=0; i<6; i++) {
        const bone = document.createElement("div");
        bone.className = "bone";
        bone.innerText = "ü¶¥";
        bone.style.left = x + "px";
        bone.style.top = y + "px";
        
        const ex = (Math.random() - 0.5) * 250;
        const ey = (Math.random() - 0.5) * 250 - 100;
        const er = Math.random() * 720;
        
        bone.style.setProperty('--ex', `${ex}px`);
        bone.style.setProperty('--ey', `${ey}px`);
        bone.style.setProperty('--er', `${er}deg`);
        
        document.body.appendChild(bone);
        setTimeout(() => bone.remove(), 900);
    }
}

// –°–ª—É—à–∞—Ç–µ–ª–∏ –¥–ª—è –∫–æ—Å—Ç–æ—á–µ–∫ –≤–µ–∑–¥–µ (–∏ —Ç–∞—á, –∏ –º—ã—à—å)
document.addEventListener("mousedown", e => createBones(e.clientX, e.clientY));
document.addEventListener("touchstart", e => createBones(e.touches[0].clientX, e.touches[0].clientY));

// –ù–∞–≤–∏–≥–∞—Ü–∏—è
function openSection(id){
    document.querySelectorAll(".section").forEach(s=>s.classList.remove("active"));
    document.querySelectorAll("nav button").forEach(b=>b.classList.remove("active"));
    document.getElementById(id).classList.add("active");
    document.getElementById("btn-"+id).classList.add("active");
    tg.HapticFeedback.impactOccurred("light");
}

// –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–µ–π—Å—Ç–≤–∏–π
document.querySelectorAll(".actionBtn").forEach(btn=>{
    btn.addEventListener("click", () => {
        const type = btn.dataset.type;
        const overlay = document.getElementById("overlay");
        const content = document.getElementById("overlayContent");
        overlay.style.display="block";
        
        if(type === "click") {
            content.innerHTML = `<h2 style="text-align:center;">üêæ –ñ–º–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É!</h2>
            <button class="btn" id="clickerBtn" style="height:120px; font-size:40px;">üê∂</button>
            <h1 id="countDisp" style="text-align:center; font-size:50px; margin-top:20px;">${clicks}</h1>`;
            
            document.getElementById("clickerBtn").onclick = (e) => {
                clicks++; 
                updateUI();
                document.getElementById("countDisp").innerText = clicks;
                userRef.update({clicks: clicks});
                tg.HapticFeedback.impactOccurred("medium");
                createBones(e.clientX || e.touches[0].clientX, e.clientY || e.touches[0].clientY);
            };
        } else {
            content.innerHTML = `<h2>–°–∫–æ—Ä–æ...</h2><p>–†–∞–∑–¥–µ–ª ${type} –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ.</p>`;
        }
    });
});

// –ê–î–ú–ò–ù–ö–ê –î–õ–Ø –í–°–ï–•
document.getElementById("openAdmin").onclick = async () => {
    const overlay = document.getElementById("overlay");
    overlay.style.display="block";
    const content = document.getElementById("overlayContent");
    content.innerHTML = `<h2>üõ° –ë–∞–∑–∞ –î–∞–Ω–Ω—ã—Ö</h2><p>–†–µ–¥–∞–∫—Ç–∏—Ä—É–π –ª—é–±–æ–≥–æ –∏–≥—Ä–æ–∫–∞:</p><div style="overflow-x:auto;"><table id="adminTable"><tr><th>–ù–∏–∫</th><th>ü™ô</th><th>üêæ</th><th></th></tr></table></div>`;
    
    const snap = await db.collection("users").get();
    const table = document.getElementById("adminTable");
    snap.forEach(doc => {
        const data = doc.data();
        const row = table.insertRow();
        row.insertCell(0).innerText = data.username || "User";
        
        const bIn = document.createElement("input"); bIn.type="number"; bIn.value = data.balance || 0;
        row.insertCell(1).appendChild(bIn);
        
        const cIn = document.createElement("input"); cIn.type="number"; cIn.value = data.clicks || 0;
        row.insertCell(2).appendChild(cIn);
        
        const save = document.createElement("button");
        save.innerText = "üíæ";
        save.className = "save-btn-min";
        save.onclick = () => {
            db.collection("users").doc(doc.id).update({
                balance: parseInt(bIn.value),
                clicks: parseInt(cIn.value)
            });
            tg.showPopup({message: "–î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!"});
        };
        row.insertCell(3).appendChild(save);
    });
};

// –°—Ç–∞—Ä—Ç
if(tg.initDataUnsafe?.user) {
    initUser(tg.initDataUnsafe.user);
} else {
    initUser({id: 123456, username: "Player"}); // –î–ª—è —Ç–µ—Å—Ç–∞
}
</script>
</body>
</html>
