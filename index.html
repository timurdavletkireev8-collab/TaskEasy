<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>EASY MONEY</title>

<script src="https://telegram.org/js/telegram-web-app.js"></script>

<!-- FIREBASE -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import {
  getFirestore, doc, getDoc, setDoc, updateDoc,
  collection, addDoc, query, where, getDocs,
  runTransaction, increment
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "YOUR_KEY",
  authDomain: "YOUR_DOMAIN",
  projectId: "YOUR_PROJECT_ID",
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const tg = window.Telegram.WebApp;
tg.expand();

const user = tg.initDataUnsafe.user;
const UID = String(user.id);
const ADMIN_ID = "7020322752";

/* ---------- INIT USER ---------- */
async function initUser(){
  const ref = doc(db,"users",UID);
  const snap = await getDoc(ref);
  if(!snap.exists()){
    await setDoc(ref,{
      balance:0,
      energy:1000,
      referrer: tg.initDataUnsafe.start_param || null,
      photo:user.photo_url || "",
      totalEarned:0
    });
  }
}
initUser();

/* ---------- UI ---------- */
window.showPage = id =>{
  document.querySelectorAll(".page").forEach(p=>p.classList.remove("active"));
  document.getElementById(id).classList.add("active");
};

window.nav = (id,e)=>{
  document.querySelectorAll(".nav img").forEach(i=>i.classList.remove("active"));
  e.target.classList.add("active");
  showPage(id);
};

/* ---------- PROFILE ---------- */
async function loadProfile(){
  const snap = await getDoc(doc(db,"users",UID));
  const d = snap.data();
  document.getElementById("balance").innerText=d.balance.toFixed(3);
  document.getElementById("energy").innerText=d.energy;
  document.getElementById("uid").innerText=UID;
  document.getElementById("tgphoto").src=d.photo||"";
}
loadProfile();

/* ---------- CLICK ---------- */
window.tap = async ()=>{
  const ref = doc(db,"users",UID);
  await runTransaction(db,async t=>{
    const s=await t.get(ref); const d=s.data();
    if(d.energy<=0) return;
    t.update(ref,{
      energy:d.energy-1,
      balance:d.balance+0.005,
      totalEarned:d.totalEarned+0.005
    });
  });
  loadProfile();
};

/* ---------- REFERRAL ---------- */
async function rewardReferrer(userId,amount){
  const us = await getDoc(doc(db,"users",userId));
  const rid = us.data().referrer;
  if(!rid) return;
  const reward = amount*0.1;
  await updateDoc(doc(db,"users",rid),{
    balance:increment(reward),
    totalEarned:increment(reward)
  });
}

/* ---------- ADMIN MENU ---------- */
window.openAdmin=()=>{
  if(UID!==ADMIN_ID) return;
  showPage("admin");
};

/* ---------- TASK APPROVE ---------- */
window.approveTask = async (uid,price)=>{
  await updateDoc(doc(db,"users",uid),{
    balance:increment(price),
    totalEarned:increment(price)
  });
  await rewardReferrer(uid,price);
};

/* ---------- COPY ---------- */
window.copyRef=()=>{
  navigator.clipboard.writeText(
    "https://t.me/DifferentEarningsBot?start="+UID
  );
  alert("–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ");
};

</script>

<style>
*{box-sizing:border-box}
html,body{margin:0;height:100%;font-family:Arial;color:white}
body{background:url("https://i.postimg.cc/2jx4fT8X/Giga-Chat-40.jpg") center/cover no-repeat}

/* TOP */
.top{display:flex;justify-content:space-between;align-items:center;padding:16px 20px}
.title{font-size:22px;font-weight:900;padding:8px 14px;background:rgba(255,255,255,.12);border:2px solid rgba(255,255,255,.8);border-radius:16px;backdrop-filter:blur(6px)}
.balance{padding:10px 14px;background:rgba(0,0,0,.55);border:2px solid rgba(255,255,255,.8);border-radius:16px}

/* PAGES */
.page{display:none;padding:20px;height:calc(100% - 150px);overflow-y:auto}
.page.active{display:block}

/* CARD */
.card{background:rgba(0,0,0,.45);border:2px solid rgba(255,255,255,.8);border-radius:22px;padding:20px;margin-bottom:20px}

/* BUTTON */
.btn{width:100%;padding:16px;margin-top:14px;font-size:16px;font-weight:600;color:white;background:rgba(0,0,0,.5);border:2px solid rgba(255,255,255,.8);border-radius:18px}
.btn-red{background:rgba(255,0,0,.35)}

/* NAV */
.nav{position:fixed;bottom:0;width:100%;height:90px;background:rgba(0,0,0,.6);display:flex;justify-content:space-around;align-items:center}
.nav img{width:48px;height:48px;opacity:.6}
.nav img.active{opacity:1}

/* CLICK */
.click-img{width:200px;height:200px;margin:30px auto;display:block;border-radius:24px;border:3px solid rgba(255,255,255,.9)}
</style>
</head>

<body>

<div class="top">
  <div class="title" onclick="openAdmin()">EASY MONEY</div>
  <div class="balance">–ë–∞–ª–∞–Ω—Å: <span id="balance">0</span>‚ÇΩ</div>
</div>

<!-- EARN -->
<div id="earn" class="page active">
  <div class="card">
    <button class="btn" onclick="showPage('referral')">–ó–∞—Ä–∞–±–æ—Ç–æ–∫ –Ω–∞ —Ä–µ—Ñ–µ—Ä–∞–ª–∞—Ö</button>
    <button class="btn" onclick="showPage('tasks')">–ó–∞—Ä–∞–±–æ—Ç–æ–∫ –Ω–∞ –∑–∞–¥–∞–Ω–∏—è—Ö</button>
    <button class="btn" onclick="showPage('click')">–ó–∞—Ä–∞–±–æ—Ç–æ–∫ –Ω–∞ –∫–ª–∏–∫–∞—Ö</button>
  </div>
</div>

<!-- REF -->
<div id="referral" class="page">
  <div class="card">
    <h3>–†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞</h3>
    <p>+10‚ÇΩ –∏ 200 —ç–Ω–µ—Ä–≥–∏–∏ –∑–∞ –∫–∞–∂–¥–æ–≥–æ</p>
    <p>+10% –æ—Ç –∑–∞—Ä–∞–±–æ—Ç–∫–∞ –¥—Ä—É–∑–µ–π</p>
    <button class="btn" onclick="copyRef()">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É</button>
    <button class="btn btn-red" onclick="showPage('earn')">–ù–∞–∑–∞–¥</button>
  </div>
</div>

<!-- CLICK -->
<div id="click" class="page">
  <div class="card">
    <p>–≠–Ω–µ—Ä–≥–∏—è: <span id="energy">0</span>/1000</p>
    <img class="click-img" src="https://i.postimg.cc/cCspvTn2/Picsart-26-01-03-04-33-45-909.png" onclick="tap()">
    <button class="btn btn-red" onclick="showPage('earn')">–ù–∞–∑–∞–¥</button>
  </div>
</div>

<!-- PROFILE -->
<div id="profile" class="page">
  <div class="card">
    <img id="tgphoto" style="width:80px;height:80px;border-radius:50%">
    <p>ID: <span id="uid"></span></p>
    <button class="btn">–ò—Å—Ç–æ—Ä–∏—è –Ω–∞—á–∏—Å–ª–µ–Ω–∏–π</button>
    <button class="btn">–ó–∞–¥–∞–Ω–∏—è –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–µ</button>
    <button class="btn">–û—Ç–∫–ª–æ–Ω—ë–Ω–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è</button>
  </div>
</div>

<!-- INFO -->
<div id="info" class="page">
  <div class="card">
<pre>
üìë –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è EASY MONEY

–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ EASY MONEY!
...
(–í–ï–°–¨ –¢–ï–ö–°–¢ –í–°–¢–ê–í–õ–ï–ù –ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô)
</pre>
  </div>
</div>

<!-- ADMIN -->
<div id="admin" class="page">
  <div class="card">
    <h3>–ê–¥–º–∏–Ω–∫–∞</h3>
    <p>ID: 7020322752</p>
  </div>
</div>

<div class="nav">
  <img src="https://i.postimg.cc/9MfvXtnQ/Picsart-26-01-03-07-41-15-897.png" class="active" onclick="nav('earn',event)">
  <img src="https://i.postimg.cc/jdGK89kw/Picsart-26-01-03-07-38-38-882.png" onclick="nav('profile',event)">
  <img src="https://i.postimg.cc/9fBhQfXL/Picsart-26-01-03-07-38-01-962.png" onclick="nav('info',event)">
</div>

</body>
</html>
