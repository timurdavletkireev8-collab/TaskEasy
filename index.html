<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>EASY MONEY</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://telegram.org/js/telegram-web-app.js"></script>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<style>
*{box-sizing:border-box}
html,body{
  margin:0;
  height:100%;
  overflow:hidden;
  font-family:Arial, sans-serif;
}

body{
  background:url("https://i.postimg.cc/2jx4fT8X/Giga-Chat-40.jpg") center/cover no-repeat;
  color:white;
}

/* TOP */
.top{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:20px 24px;
}
.title{
  font-size:44px;
  font-weight:900;
}
.balance{
  background:rgba(0,0,0,.55);
  padding:12px 18px;
  border-radius:16px;
}

/* PAGES */
.page{
  display:none;
  padding:24px;
  height:calc(100% - 180px);
  overflow-y:auto;
}
.page.active{display:block}

/* CARDS */
.card{
  background:rgba(0,0,0,.45);
  border-radius:22px;
  padding:24px;
  margin-bottom:20px;
}

/* BUTTONS */
.btn{
  width:100%;
  padding:18px;
  margin-top:16px;
  font-size:18px;
  border:none;
  border-radius:18px;
  color:white;
  background:linear-gradient(
    135deg,
    rgba(255,255,255,.18),
    rgba(0,0,0,.45)
  );
}

/* INPUT */
input, textarea{
  width:100%;
  padding:14px;
  margin-top:12px;
  border-radius:14px;
  border:none;
  background:rgba(0,0,0,.5);
  color:white;
  font-size:16px;
}

/* BOTTOM NAV */
.nav{
  position:fixed;
  bottom:0;
  width:100%;
  height:100px;
  background:rgba(0,0,0,.55);
  display:flex;
  justify-content:space-around;
  align-items:center;
}
.nav div{
  font-size:32px;
  opacity:.5;
}
.nav .active{opacity:1}

/* CLICK */
.coin{
  font-size:96px;
  text-align:center;
  margin:40px 0;
}
</style>
</head>

<body>

<div class="top">
  <div class="title">EASY MONEY</div>
  <div class="balance">–ë–∞–ª–∞–Ω—Å: <span id="balance">0</span>‚ÇΩ</div>
</div>

<!-- –ó–ê–†–ê–ë–û–¢–û–ö -->
<div id="earn" class="page active">
  <div class="card">
    <button class="btn" onclick="openRef()">–ó–∞—Ä–∞–±–æ—Ç–æ–∫ –Ω–∞ —Ä–µ—Ñ–µ—Ä–∞–ª–∞—Ö</button>
    <button class="btn" onclick="show('tasks')">–ó–∞—Ä–∞–±–æ—Ç–æ–∫ –Ω–∞ –∑–∞–¥–∞–Ω–∏—è—Ö</button>
    <button class="btn" onclick="show('click')">–ó–∞—Ä–∞–±–æ—Ç–æ–∫ –Ω–∞ –∫–ª–∏–∫–∞—Ö</button>
  </div>
</div>

<!-- –ó–ê–î–ê–ù–ò–Ø -->
<div id="tasks" class="page">
  <div class="card">
    <h3>–î–æ—Å—Ç—É–ø–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è</h3>
    <div id="taskList"></div>
    <button class="btn" onclick="show('earn')">–ù–∞–∑–∞–¥</button>
  </div>
</div>

<!-- –ü–†–û–§–ò–õ–¨ -->
<div id="profile" class="page">
  <div class="card">
    <img id="avatar" width="90" style="border-radius:50%">
    <div>ID: <span id="uid"></span></div>
    <div>–í—ã–ø–æ–ª–Ω–µ–Ω–æ: <span id="done">0</span></div>
    <div>–û—Ç–∫–ª–æ–Ω–µ–Ω–æ: <span id="fail">0</span></div>
  </div>

  <div class="card">
    <b>–ò—Å—Ç–æ—Ä–∏—è –Ω–∞—á–∏—Å–ª–µ–Ω–∏–π</b>
    <div id="history"></div>
  </div>
</div>

<!-- –ò–ù–§–û -->
<div id="info" class="page">
  <div class="card">
    <button class="btn" onclick="tg.openTelegramLink('https://t.me/news')">–ù–æ–≤–æ—Å—Ç–∏</button>
    <button class="btn" onclick="tg.openTelegramLink('https://t.me/sup')">–ü–æ–¥–¥–µ—Ä–∂–∫–∞</button>
    <button id="adminOpen" class="btn" style="display:none" onclick="show('admin')">
      –ê–¥–º–∏–Ω–∫–∞
    </button>
  </div>
</div>

<!-- –ê–î–ú–ò–ù–ö–ê -->
<div id="admin" class="page">
  <div class="card">
    <h3>–î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ</h3>
    <input id="aName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ">
    <textarea id="aDesc" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ"></textarea>
    <input id="aPrice" placeholder="–¶–µ–Ω–∞">
    <input id="aLink" placeholder="–°—Å—ã–ª–∫–∞">
    <button class="btn" onclick="addTask()">–î–æ–±–∞–≤–∏—Ç—å</button>
  </div>

  <div class="card">
    <h3>–ó–∞–¥–∞–Ω–∏—è</h3>
    <div id="adminTasks"></div>
    <button class="btn" onclick="show('info')">–ù–∞–∑–∞–¥</button>
  </div>
</div>

<!-- –ö–õ–ò–ö–ò -->
<div id="click" class="page">
  <div class="card">
    –≠–Ω–µ—Ä–≥–∏—è: <span id="energy">1000</span>/1000
    <div class="coin" onclick="tap()">ü™ô</div>
    <button class="btn" onclick="show('earn')">–ù–∞–∑–∞–¥</button>
  </div>
</div>

<!-- –ù–ê–í -->
<div class="nav">
  <div id="n-earn" class="active" onclick="show('earn')">üí∞</div>
  <div id="n-profile" onclick="show('profile')">üë§</div>
  <div id="n-info" onclick="show('info')">‚ÑπÔ∏è</div>
</div>

<script>
const tg = window.Telegram.WebApp;
tg.expand();

const user = tg.initDataUnsafe.user;
const userID = user?.id || 0;

document.getElementById("uid").innerText = userID;
document.getElementById("avatar").src = user?.photo_url || "";

if(userID === 7020322752){
  document.getElementById("adminOpen").style.display="block";
}

let balance = 0;
let energy = 1000;

/* NAV */
function show(id){
  document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
  document.querySelectorAll('.nav div').forEach(n=>n.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  document.getElementById('n-'+id)?.classList.add('active');
}

/* REF */
function openRef(){
  alert(
`–ü—Ä–∏–≥–ª–∞—à–∞–π—Ç–µ –¥—Ä—É–∑–µ–π:
10‚ÇΩ + 200 —ç–Ω–µ—Ä–≥–∏–∏

https://t.me/DifferentEarningsBot?start=${userID}`
  );
}

/* CLICK */
function tap(){
  if(energy<=0) return;
  energy--;
  balance+=0.005;
  document.getElementById("energy").innerText=energy;
  document.getElementById("balance").innerText=balance.toFixed(3);
}

/* FIREBASE */
firebase.initializeApp({
  apiKey: "AIzaSyApcL3hN95djDhI-26L623jHHbzREswfQE",
  authDomain: "cash-1968a.firebaseapp.com",
  databaseURL: "https://cash-1968a-default-rtdb.firebaseio.com",
  projectId: "cash-1968a"
});

const db = firebase.database();
const tasksRef = db.ref("tasks");

/* ADMIN */
function addTask(){
  const t = {
    name:aName.value,
    desc:aDesc.value,
    price:aPrice.value,
    link:aLink.value
  };
  tasksRef.push(t);
}

tasksRef.on("value",s=>{
  taskList.innerHTML="";
  adminTasks.innerHTML="";
  s.forEach(c=>{
    const t=c.val();
    taskList.innerHTML+=`<div class="card">${t.name}</div>`;
    adminTasks.innerHTML+=`
      <div class="card">
        ${t.name}
        <button class="btn" onclick="tasksRef.child('${c.key}').remove()">–£–¥–∞–ª–∏—Ç—å</button>
      </div>`;
  });
});
</script>

</body>
</html>
