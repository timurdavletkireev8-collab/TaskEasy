<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Dog Money üê∂</title>
<style>
:root { --gold: linear-gradient(135deg,#ffcc00,#ff9f00);}
*{box-sizing:border-box;font-family:'Segoe UI',system-ui,sans-serif;-webkit-tap-highlight-color:transparent;}
html,body{margin:0;padding:0;height:100%;background:radial-gradient(circle at top,#fff2d6,#ffd28a);overflow-x:hidden;}
header{text-align:center;padding:20px 15px 10px;}
.header-img{width:100%;max-width:340px;border-radius:22px;box-shadow:0 14px 35px rgba(0,0,0,0.3);}
.small{font-size:14px;opacity:0.7;margin-top:8px;}
.container{padding:15px;padding-bottom:120px;}
.card{background:#fff;border-radius:22px;padding:18px;margin-bottom:16px;box-shadow:0 15px 35px rgba(0,0,0,0.12);animation:fadeUp 0.25s ease;}
@keyframes fadeUp{from{opacity:0;transform:translateY(20px);}to{opacity:1;transform:translateY(0);}}
.btn{width:100%;padding:14px;border:none;border-radius:18px;font-size:16px;font-weight:600;cursor:pointer;background:var(--gold);box-shadow:0 8px 20px rgba(255,170,0,0.6);transition:0.2s;}
.btn:active{transform:scale(0.95);}
.section{display:none;animation:slide 0.25s ease;}
.section.active{display:block;}
@keyframes slide{from{opacity:0;transform:translateX(20px);}to{opacity:1;transform:translateX(0);}}
nav{position:fixed;bottom:12px;left:12px;right:12px;height:64px;background:rgba(255,255,255,0.95);backdrop-filter:blur(12px);border-radius:22px;display:flex;padding:6px;z-index:999;box-shadow:0 10px 30px rgba(0,0,0,0.25);}
nav button{flex:1;border:none;background:none;border-radius:16px;font-size:13px;font-weight:600;cursor:pointer;}
nav button.active{background:var(--gold);box-shadow:0 6px 18px rgba(255,170,0,0.7);}
.bone{position:fixed;font-size:28px;pointer-events:none;animation:boneFly 0.8s ease forwards;z-index:1000;}
@keyframes boneFly{0%{opacity:1;transform:translateY(0) scale(1);}100%{opacity:0;transform:translateY(-60px) scale(1.6);}}
.profile-photo{width:64px;height:64px;border-radius:50%;object-fit:cover;margin-bottom:8px;}
/* Fullscreen overlay */
#overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.95);display:none;z-index:10000;color:#fff;overflow:auto;padding:20px;}
#overlay h2{margin-top:0;}
#overlay .closeBtn{position:absolute;top:12px;right:12px;background:#ff9f00;color:#fff;border:none;padding:10px 16px;border-radius:12px;font-weight:600;cursor:pointer;}
#overlay input{width:80px;margin-right:8px;}
#adminTable input{width:60px;}
</style>

<script src="https://www.gstatic.com/firebasejs/10.2.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.2.0/firebase-firestore.js"></script>
<script src="https://telegram.org/js/telegram-web-app.js"></script>

</head>
<body>

<header>
  <img class="header-img" src="https://i.postimg.cc/nrrTt15j/Giga-Chat-36.jpg" alt="Dog Money">
  <div class="small">–ó–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π —Å —Å–æ–±–∞—á–∫–∞–º–∏ üê∂</div>
</header>

<div class="container">

<!-- –ó–ê–†–ê–ë–û–¢–û–ö -->
<div id="earn" class="section active">
  <div class="card">
    <h2>üêæ –ö–ª–∏–∫–∏</h2>
    <p>–ñ–º–∏ –∏ –ø–æ–ª—É—á–∞–π –º–æ–Ω–µ—Ç—ã</p>
    <button class="btn actionBtn" data-type="click">–ö–ª–∏–∫–Ω—É—Ç—å üêï</button>
    <p id="clicks">–ö–ª–∏–∫–æ–≤: 0</p>
  </div>
  <div class="card">
    <h2>üìã –ó–∞–¥–∞–Ω–∏—è</h2>
    <p>–í—ã–ø–æ–ª–Ω—è–π –∑–∞–¥–∞–Ω–∏—è –∏ –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π</p>
    <button class="btn actionBtn" data-type="tasks">–ü–µ—Ä–µ–π—Ç–∏ –∫ –∑–∞–¥–∞–Ω–∏—è–º</button>
  </div>
  <div class="card">
    <h2>ü§ù –†–µ—Ñ–µ—Ä–∞–ª—ã</h2>
    <p>–ü—Ä–∏–≥–ª–∞—à–∞–π –¥—Ä—É–∑–µ–π –∏ –ø–æ–ª—É—á–∞–π –±–æ–Ω—É—Å</p>
    <button class="btn actionBtn" data-type="referrals">–ü–µ—Ä–µ–π—Ç–∏</button>
  </div>
</div>

<!-- –ü–†–û–§–ò–õ–¨ -->
<div id="profile" class="section">
  <div class="card" id="profileCard">
    <img src="" alt="–§–æ—Ç–æ" class="profile-photo" id="profilePhoto">
    <h2 id="profileUsername">‚Äî</h2>
    <p>ID: <span id="profileId">‚Äî</span></p>
    <p>–ë–∞–ª–∞–Ω—Å: <b id="profileBalance">0 ü™ô</b></p>
    <p>–ö–ª–∏–∫–∏: <span id="profileClicks">0</span></p>
  </div>
</div>

<!-- –ò–ù–§–û -->
<div id="info" class="section">
  <div class="card">
    <h2>üì∞ –ù–æ–≤–æ—Å—Ç–Ω–æ–π –∫–∞–Ω–∞–ª</h2>
    <p>–í—Å–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏ –Ω–æ–≤–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞.</p>
    <button class="btn">–ü–µ—Ä–µ–π—Ç–∏ –≤ –∫–∞–Ω–∞–ª</button>
  </div>

  <div class="card">
    <h2>üõ† –ü–æ–¥–¥–µ—Ä–∂–∫–∞</h2>
    <p><b>@support_dogmoney</b></p>
  </div>

  <div class="card" id="adminCard" style="display:none;">
    <h2>üõ° –ê–¥–º–∏–Ω–∫–∞</h2>
    <p>–¢–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∞</p>
    <button class="btn" id="openAdmin">–ü–µ—Ä–µ–π—Ç–∏</button>
  </div>

  <div class="card">
    <h2>üìò –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ</h2>
    <p><b>1.</b> –ü–µ—Ä–µ–π–¥–∏ –≤ ¬´–ó–∞—Ä–∞–±–æ—Ç–∞—Ç—å¬ª</p>
    <p><b>2.</b> –ö–ª–∏–∫–∞–π, –≤—ã–ø–æ–ª–Ω—è–π –∑–∞–¥–∞–Ω–∏—è</p>
    <p><b>3.</b> –ó–æ–≤–∏ –¥—Ä—É–∑–µ–π</p>
    <p><b>4.</b> –°–ª–µ–¥–∏ –∑–∞ –±–∞–ª–∞–Ω—Å–æ–º</p>
  </div>
</div>

</div>

<nav>
  <button id="btn-earn" class="active" onclick="openSection('earn')">üí∞ –ó–∞—Ä–∞–±–æ—Ç–∞—Ç—å</button>
  <button id="btn-profile" onclick="openSection('profile')">üë§ –ü—Ä–æ—Ñ–∏–ª—å</button>
  <button id="btn-info" onclick="openSection('info')">‚ÑπÔ∏è –ò–Ω—Ñ–æ</button>
</nav>

<!-- Fullscreen Overlay -->
<div id="overlay">
  <button class="closeBtn">–ó–∞–∫—Ä—ã—Ç—å</button>
  <div id="overlayContent"></div>
</div>

<script>
const tg = window.Telegram.WebApp;
tg.ready();

// Firebase
const firebaseConfig = {
    apiKey: "AIzaSyDeY43dAjpJ2NxHneG4W66veHNBiQ5jhfA",
    authDomain: "dogsmoney.firebaseapp.com",
    projectId: "dogsmoney",
    storageBucket: "dogsmoney.firebasestorage.app",
    messagingSenderId: "339745413806",
    appId: "1:339745413806:web:08f8fdd856ee92a3002b3f"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

// User
const userId = tg.initDataUnsafe?.user?.id || 0;
const username = tg.initDataUnsafe?.user?.username || "–±–µ–∑ username";
const photo_url = tg.initDataUnsafe?.user?.photo_url || "";
const userRef = db.collection("users").doc(String(userId));

let clicks = 0;
let balance = 0;

// Init user
userRef.get().then(docSnap => {
    if (!docSnap.exists) {
        userRef.set({ username, photo_url, balance: 0, clicks: 0, referrals: [] });
    } else {
        const data = docSnap.data();
        clicks = data.clicks || 0;
        balance = data.balance || 0;
        document.getElementById("profileBalance").innerText = balance + " ü™ô";
        document.getElementById("profileClicks").innerText = clicks;
    }
    document.getElementById("profileUsername").innerText = "@" + username;
    document.getElementById("profileId").innerText = userId;
    document.getElementById("profilePhoto").src = photo_url;
    document.getElementById("personalLinkBtn").innerText = "–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞: @dogeasymoneybot?start=" + userId;
});

// –ö–ª–∏–∫–∏
document.querySelectorAll(".actionBtn").forEach(btn=>{
    btn.addEventListener("click", ()=>openOverlay(btn.dataset.type));
});

function openOverlay(type){
    const overlay = document.getElementById("overlay");
    const content = document.getElementById("overlayContent");
    overlay.style.display = "block";

    if(type==="click"){
        content.innerHTML = `<h2>üêæ –ö–ª–∏–∫–∏</h2><p>–ñ–º–∏ –∏ –ø–æ–ª—É—á–∞–π –º–æ–Ω–µ—Ç—ã!</p>
        <button class="btn" id="clickOverlayBtn">–ö–ª–∏–∫–Ω—É—Ç—å üêï</button>
        <p id="clickOverlayCount">–ö–ª–∏–∫–æ–≤: ${clicks}</p>`;
        document.getElementById("clickOverlayBtn").addEventListener("click", ()=>{
            clicks++;
            document.getElementById("clickOverlayCount").innerText = "–ö–ª–∏–∫–æ–≤: " + clicks;
            document.getElementById("clicks").innerText = "–ö–ª–∏–∫–æ–≤: " + clicks;
            document.getElementById("profileClicks").innerText = clicks;
            userRef.update({ clicks });
            tg.HapticFeedback.impactOccurred("medium");
        });
    } else if(type==="tasks"){
        content.innerHTML = `<h2>üìã –ó–∞–¥–∞–Ω–∏—è</h2><p>–ó–¥–µ—Å—å –±—É–¥—É—Ç –∑–∞–¥–∞–Ω–∏—è –¥–ª—è –∑–∞—Ä–∞–±–æ—Ç–∫–∞.</p>`;
    } else if(type==="referrals"){
        content.innerHTML = `<h2>ü§ù –†–µ—Ñ–µ—Ä–∞–ª—ã</h2><p>–ü—Ä–∏–≥–ª–∞—à–∞–π –¥—Ä—É–∑–µ–π –∏ –ø–æ–ª—É—á–∞–π –±–æ–Ω—É—Å!</p>`;
    }
}

document.querySelector("#overlay .closeBtn").addEventListener("click", ()=>{
    document.getElementById("overlay").style.display="none";
});

// –ù–∞–≤–∏–≥–∞—Ü–∏—è
function openSection(id) {
    document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
    document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    document.getElementById('btn-' + id).classList.add('active');
    tg.HapticFeedback.impactOccurred("light");
    if (id === "info" && userId === 7020322752) {
        document.getElementById("adminCard").style.display = "block";
    }
}

// –ö–æ—Å—Ç–æ—á–∫–∞
function spawnBone(x, y){
    const bone=document.createElement("div");
    bone.className="bone";
    bone.innerText="ü¶¥";
    bone.style.left=(x-12)+"px";
    bone.style.top=(y-20)+"px";
    document.body.appendChild(bone);
    setTimeout(()=>bone.remove(),800);
}
document.addEventListener("click", e=>spawnBone(e.clientX,e.clientY));
document.addEventListener("touchstart", e=>spawnBone(e.touches[0].clientX,e.touches[0].clientY));

// --- –†–µ–∞–ª—å–Ω–∞—è –∞–¥–º–∏–Ω–∫–∞ ---
document.getElementById("openAdmin").addEventListener("click", async ()=>{
    const overlay = document.getElementById("overlay");
    overlay.style.display="block";
    const content = document.getElementById("overlayContent");
    content.innerHTML = `<h2>üõ° –ê–¥–º–∏–Ω–∫–∞</h2><table border="1" id="adminTable"><tr><th>ID</th><th>Username</th><th>–ë–∞–ª–∞–Ω—Å</th><th>–ö–ª–∏–∫–∏</th><th>–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</th></tr></table>`;

    const usersSnap = await db.collection("users").get();
    const table = document.getElementById("adminTable");
    usersSnap.forEach(doc=>{
        const data = doc.data();
        const row = table.insertRow();
        row.insertCell(0).innerText = doc.id;
        row.insertCell(1).innerText = data.username;
        const balCell = row.insertCell(2);
        const balInput = document.createElement("input");
        balInput.type="number"; balInput.value=data.balance||0;
        balCell.appendChild(balInput);
        const clicksCell = row.insertCell(3);
        const clicksInput = document.createElement("input");
        clicksInput.type="number"; clicksInput.value=data.clicks||0;
        clicksCell.appendChild(clicksInput);
        const saveCell = row.insertCell(4);
        const saveBtn = document.createElement("button");
        saveBtn.innerText="–°–æ—Ö—Ä–∞–Ω–∏—Ç—å";
        saveBtn.className="btn";
        saveBtn.addEventListener("click", ()=>{
            db.collection("users").doc(doc.id).update({
                balance: parseInt(balInput.value),
                clicks: parseInt(clicksInput.value)
            });
            alert(`–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ –¥–ª—è ${data.username}`);
        });
        saveCell.appendChild(saveBtn);
    });
});
</script>

</body>
</html>
